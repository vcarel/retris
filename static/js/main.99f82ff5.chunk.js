(this.webpackJsonpretris=this.webpackJsonpretris||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){e.exports=n(28)},,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(7),s=n(1),o=n.n(s),c=n(3),l=n(5),u=n(8),m=n(9),f=n(11),h=n(10),p=n(2),d=n(12),v=(n(22),function(e){var t=e.shape;return r.a.createElement("div",{className:"block ".concat(" "===t?"void":t)})}),y=(n(23),n(24),function(e){var t=e.filling,n=e.stack,a=e.rowsToDrop;return r.a.createElement("div",{className:"stack "+(t?"filling":"")},n.map((function(e,t){return r.a.createElement("div",{key:t,className:"row "+((a||[]).includes(t)?"animateRowDrop":"")},e.map((function(e,t){return r.a.createElement(v,{key:t,shape:e})})))})))}),k=function(){return r.a.createElement("div",{className:"backdrop"},r.a.createElement("div",{className:"text"},r.a.createElement("h3",null,"New Game"),r.a.createElement("p",{className:"blink"},"<Press any key>")))},b=["Ouch!","Too bad!","That hurts!"],w=function(){return r.a.createElement("div",{className:"backdrop"},r.a.createElement("div",{className:"text"},r.a.createElement("h3",null,b[Math.floor(Math.random()*b.length)]),r.a.createElement("p",{className:"blink"},"<Press any key>")))},g=function(){return r.a.createElement("div",{className:"backdrop"},r.a.createElement("div",{className:"text"},r.a.createElement("h3",null,"Pause"),r.a.createElement("p",{className:"blink"},"<Press any key>")))},E=n(4),O={I:[["I","I","I","I"]],J:[["J","J","J"],[" "," ","J"]],L:[["L","L","L"],["L"," "," "]],O:[["O","O"],["O","O"]],S:[[" ","S","S"],["S","S"," "]],T:[["T","T","T"],[" ","T"," "]],Z:[["Z","Z"," "],[" ","Z","Z"]]};function S(e,t){var n=e.sprite,a=e.bottom,r=e.left,i=a-n.length+1,s=r+n[0].length-1;return t.map((function(e,t){return t<i||t>a?e:e.map((function(e,a){if(a<r||a>s)return e;var o=n[t-i][a-r];return" "===o?e:o}))}))}function T(e,t){var n=e.sprite,a=e.bottom,r=e.left,i=a-n.length+1,s=r+n[0].length-1;return r<0||a>=t.length||s>=t[0].length||n.some((function(e,n){return n+i>=0&&e.some((function(e,a){return" "!==e&&" "!==t[n+i][a+r]}))}))}function D(e,t){var n=Array(e[0].length).fill(" ");return t.reduce((function(e,t){return e.splice(t,1),[n].concat(Object(E.a)(e))}),Object(E.a)(e))}function I(e){return new Promise((function(t){return setTimeout(t,e)}))}n(25);var N={stack:[[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "],[" "," ","O","O"," "," "," "," "," "," "," ","I"],["J"," ","O","O"," "," "," "," "," "," "," ","I"],["J"," ","Z","Z","T","T","T"," ","S","S"," ","I"],["J","J"," ","Z","Z","T"," ","S","S","L","L","I"]],tetromino:null,status:"new",level:null,rowsToDrop:[]};function j(e){return Array(18).fill(Array(12).fill(e))}function L(){return{sprite:O[x()],bottom:1,left:5}}function x(){var e=Object.keys(O);return e[Math.floor(Math.random()*e.length)]}var J=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state=N,n.handleKeyDown=n.handleKeyDown.bind(Object(p.a)(n)),n.handleVisibilityChange=n.handleVisibilityChange.bind(Object(p.a)(n)),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("visibilitychange",this.handleVisibilityChange)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("visibilityChange",this.handleVisibilityChange)}},{key:"render",value:function(){var e=this.state,t=e.rowsToDrop,n=e.stack,a=e.status,i=e.tetromino;return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"left pane"}),r.a.createElement("div",{className:"middle pane"},r.a.createElement(y,{stack:i?S(i,n):n,rowsToDrop:t}),"new"===a&&r.a.createElement(k,null),"pause"===a&&r.a.createElement(g,null),"end"===a&&r.a.createElement(w,null),"filling"===a&&r.a.createElement(y,{filling:!0,stack:j(x())})),r.a.createElement("div",{className:"right pane"}))}},{key:"handleKeyDown",value:function(e){var t=e.code,n=e.key,a=this.state.status;if("new"===a||"end"===a)(1===n.length||["Enter","Space"].includes(t))&&this.startNewGame();else if("pause"===a)(1===n.length||["Enter","Space"].includes(t))&&this.resumeGame();else if("playing"===a){var r=this.state.stack,i=this.state,s=i.tetromino,o=i.tetromino,c=o.bottom,u=o.left,m=o.sprite;if("ArrowLeft"===t)u--;else if("ArrowRight"===t)u++;else if("ArrowDown"===t)c++;else if("ArrowUp"===t||"End"===t)u+=Math.floor(m[0].length/2),m=function(e){return e[0].map((function(t,n){return e.map((function(t,a){return e[e.length-a-1][n]}))}))}(m),u-=Math.floor(m[0].length/2);else if("Home"===t)u+=Math.floor(m[0].length/2),m=function(e){return e[0].map((function(t,n){return e.map((function(t,a){return e[a][t.length-n-1]}))}))}(m),u-=Math.floor(m[0].length/2);else if("Space"===t||"Enter"===t){for(;!T(Object(l.a)({},s,{bottom:++c}),r););c--}else{if("Escape"!==t)return;this.pauseGame()}T(s=Object(l.a)({},s,{bottom:c,left:u,sprite:m}),r)||this.setState({tetromino:s})}}},{key:"handleVisibilityChange",value:function(){document.hidden&&"playing"===this.state.status&&this.pauseGame()}},{key:"startNewGame",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fillStack();case 2:return this.setState({stack:j(" "),level:0,rowsToDrop:[],status:null,tetromino:null}),e.next=5,I(1e3);case 5:this.setState({tetromino:L()}),this.resumeGame();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pauseGame",value:function(){this.setState({status:"pause"}),clearInterval(this.dropIntervalId)}},{key:"resumeGame",value:function(){var e=this;this.setState({status:"playing"}),this.dropIntervalId=setInterval((function(){return e.moveTetrominoDown()}),1e3)}},{key:"moveTetrominoDown",value:function(){var e=this.state,t=e.stack,n=e.tetromino,a=e.tetromino.bottom,r=Object(l.a)({},n,{bottom:a+1});if(T(r,t))if(a>1){var i=S(n,t),s=function(e){return e.reduce((function(t,n,a){return e[a].every((function(e){return" "!==e}))?[].concat(Object(E.a)(t),[a]):t}),[])}(i);this.setState({stack:i,tetromino:L(),rowsToDrop:s}),s.length>0&&this.deferDropLines()}else this.setState({status:a>1?"playing":"end"}),clearInterval(this.dropIntervalId);else this.setState({tetromino:r})}},{key:"deferDropLines",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(400);case 2:t=this.state,n=t.rowsToDrop,a=t.stack,this.setState({stack:D(a,n),rowsToDrop:[]});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fillStack",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:"filling"}),e.next=3,I(1700);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(a.Component);n(26),n(27);Object(i.render)(r.a.createElement(J,null),document.getElementById("root"))}],[[13,1,2]]]);
//# sourceMappingURL=main.99f82ff5.chunk.js.map